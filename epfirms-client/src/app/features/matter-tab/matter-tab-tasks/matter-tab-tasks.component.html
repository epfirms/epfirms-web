<ng-container *ngIf="matter">
  <div class="p-4">
    <button class="button-white-icon-sm" (click)="createMatterTask(matter.id);">
      <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd"
          d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z"
          clip-rule="evenodd" />
      </svg>
      Add Task
    </button>
    <button class="button-white-icon-sm ml-2" (click)="openCaseTemplateDialog()">
      <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd"
          d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z"
          clip-rule="evenodd" />
      </svg>
      Add Tasks From Template
    </button>
  </div>
  <div class="align-middle inline-block min-w-full">
    <table class="min-w-full">
      <thead>
        <tr class="border-t border-gray-200" [class.border-b]="!matter.matter_tasks.length">
          <th class="
                px-6
                py-3
                border-gray-200
                bg-white
                text-left text-xs
                font-medium
                text-gray-500
                uppercase
                tracking-wider
              "></th>
          <th class="
                px-3
                py-3
                border-gray-200
                bg-white
                text-left text-xs
                font-medium
                text-gray-500
                uppercase
                tracking-wider
                whitespace-nowrap
                border-r
              ">
            <span>Task</span>
          </th>
          <th class="
                px-3
                py-3
                border-gray-200
                bg-white
                text-left text-xs
                font-medium
                text-gray-500
                uppercase
                tracking-wider
                whitespace-nowrap
                border-r border-l
              ">
            Assignee
          </th>
          <th class="
                hidden
                md:table-cell
                px-6
                py-3
                border-gray-200
                bg-white
                text-left text-xs
                font-medium
                text-gray-500
                uppercase
                tracking-wider
                whitespace-nowrap
                border-l
              "
            >
              Due Date
            </th>
            <th
            class="
              hidden
              md:table-cell
              px-6
              py-3
              border-gray-200
              bg-white
              text-left text-xs
              font-medium
              text-gray-500
              uppercase
              tracking-wider
              whitespace-nowrap
              border-l
            "
          >
            Hours
          </th>
            <th
            class="
              table-cell
              px-4
              py-3
              bg-white
              text-left text-xs
              font-medium
              text-gray-500
              uppercase
              tracking-wider
              whitespace-nowrap
            ">
          </th>
        </tr>
      </thead>
      <tbody class="bg-white">
        <ng-container *ngIf="matter.matter_tasks.length">
          <tr class="task-row group" *ngFor="let task of matter.matter_tasks; trackBy: trackByIndex">
            <td class="w-16 border-t border-b border-gray-200 text-center group-focus:bg-blue-50">
              <input type="checkbox" class="focus:ring-0 h-4 w-4 text-blue-600 border-gray-300 rounded align-sub"
                [checked]="task.completed" (change)="updateTask(task, 'completed', $event.target.checked)" />
            </td>
            <td class="
                px-1
                py-1
                max-w-0
                w-full
                whitespace-nowrap
                text-sm
                font-medium
                text-gray-900
                border-r border-t border-b border-gray-200
              ">
              <div class="flex items-center">
                <editable-input [value]="task.name" placeholder="Enter a task name" [enterKey]="true"
                  (onChange)="updateTask(task, 'name', $event)" #taskName class="flex-1"></editable-input>
                <app-task-file-button *ngIf="task.matter_task_files.length" [files]="task.matter_task_files"
                  [readonly]="true"></app-task-file-button>

              </div>
            </td>
            <td class="
              px-1
              py-1
              w-full
              whitespace-nowrap
              text-sm
              font-medium
              text-gray-900
              border-r border-t border-b border-gray-200
              ">
              <div>
                <ep-input-group>
                  <ep-avatar ep-input-icon epSize="xsmall" [epSrc]="task.assignee.profile_image"
                    [epText]="task.assignee.full_name"></ep-avatar>

                  <input ep-input [epEditable]="true" type="text" [ngModel]="task.assignee_id"
                    (ngModelChange)="filterStaffMembers($event)" [epAutocomplete]="auto">
                </ep-input-group>
                <ep-autocomplete #auto="epAutocomplete" [displayWith]="displayFn"
                  (optionSelected)="updateTask(task, 'assignee_id', $event.option.value)" panelWidth="auto">
                  <ep-option *ngFor="let staffMember of filteredStaffMembers" [value]="staffMember.user.id">
                    <ep-avatar epSize="xsmall" [epSrc]="staffMember.user.profile_image"
                      [epText]="staffMember.user.full_name">
                    </ep-avatar> <span class="font-normal ml-3 block truncate">
                      {{staffMember.user.full_name}}
                    </span>
                  </ep-option>
                </ep-autocomplete>
              </div>
            </td>

            <td class="
              px-1
              py-1
              text-sm
              font-medium
              text-gray-900
              border-t border-b border-gray-200 border-r
              "
            >
              <div>
                <editable-datepicker [date]="task.due" (dateChanged)="updateTask(task, 'due', $event)">
                </editable-datepicker>
              </div>
            </td>

            <td
            class="
              px-1
              py-1
              max-w-0
              w-full
              whitespace-nowrap
              text-sm
              font-medium
              text-gray-900
              border-t border-b border-gray-200
            "
          >
          <div>
            <editable-input [value]="task.hours" placeholder="Enter hours" [enterKey]="false" (onChange)="updateTask(task, 'hours', $event)" #taskHours></editable-input>
          </div>
          </td>

            <td
            class="
            px-1
            py-1
            text-sm
            font-medium
            text-gray-900
            border-t border-b border-gray-200
            ">
              <div class="items-center hidden group-hover:flex">

                <button (click)="deleteTask(task.id)" type="button"
                  class="-m-2 p-2 rounded-full flex items-center text-gray-300 hover:text-gray-600"
                  id="options-menu-0-button" aria-expanded="false" aria-haspopup="true">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd"
                      d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z"
                      clip-rule="evenodd" />
                  </svg>
                </button>
              </div>
            </td>
          </tr>
        </ng-container>

        <ng-container *ngIf="!matter.matter_tasks.length">
          <tr>
            <td colspan="4" class="p-4">
              <button (click)="createMatterTask(matter.id);" type="button"
                class="relative block w-full rounded-lg p-12 text-center focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">


                <svg xmlns="http://www.w3.org/2000/svg" class="mx-auto h-12 w-12 text-gray-400" fill="none"
                  viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1"
                    d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
                </svg>
                <span class="mt-2 block text-sm font-medium text-gray-400">
                  No tasks
                </span>
              </button>
            </td>
          </tr>
        </ng-container>
        <!-- More projects... -->
      </tbody>
    </table>
  </div>
</ng-container>