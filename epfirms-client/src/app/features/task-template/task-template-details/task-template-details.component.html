<div class="px-4 pt-5 pb-6 sm:p-6 sm:pb-12 flex-auto">
  <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
    <h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title">
      Task Template
    </h3>
  </div>
  <div class="mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6">
    <div class="col-span-1 sm:col-span-3">
      <label for="template-name" class="block text-sm font-medium text-gray-700">
        Template name
      </label>
      <div class="mt-1">
        <input [(ngModel)]="template.template_name" type="text" name="template-name" id="template-name"
          autocomplete="off"
          class="shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md">
      </div>
    </div>

    <div class="col-span-1 sm:col-span-2">
      <label for="template-name" class="block text-sm font-medium text-gray-700">
        Field of law
      </label>
      <div class="mt-1">
        <select [(ngModel)]="template.law_category"
          class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md">
          <option *ngFor="let lawCategory of taskTemplateLawCategories" [ngValue]="lawCategory">{{lawCategory}}</option>
        </select>
      </div>
    </div>

    <div class="col-span-1 sm:col-span-1">
      <label for="template-name" class="block text-sm font-medium text-gray-700">
        State
      </label>
      <div class="mt-1">
        <select [(ngModel)]="template.state_category"
          class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md">
          <option *ngFor="let state of usaStates" [ngValue]="state.abbreviation">{{state.name}}</option>
        </select>
      </div>
    </div>
  </div>
  <div class="mt-6 max-h-72 overflow-y-auto rounded-md border border-gray-200">
    <table class="min-w-full" *ngIf="template.firm_template_tasks.length">
      <thead>
        <tr>
          <th class="
                  px-3
                  py-3
                  border-gray-200
                  bg-white
                  text-left text-xs
                  font-medium
                  text-gray-500
                  uppercase
                  tracking-wider
                  whitespace-nowrap
                  border-r
                ">
            <span>Task</span>
          </th>
          <th class="
                  px-3
                  py-3
                  border-gray-200
                  bg-white
                  text-left text-xs
                  font-medium
                  text-gray-500
                  uppercase
                  tracking-wider
                  whitespace-nowrap
                  border-r border-l
                ">
            Assignee
          </th>
          <th class="
                  hidden
                  md:table-cell
                  px-6
                  py-3
                  border-gray-200
                  bg-white
                  text-left text-xs
                  font-medium
                  text-gray-500
                  uppercase
                  tracking-wider
                  whitespace-nowrap
                  border-l
                ">
            Days until due
          </th>
          <!-- <th class="
          hidden
          md:table-cell
          px-6
          py-3
          border-gray-200
          bg-white
          text-left text-xs
          font-medium
          text-gray-500
          uppercase
          tracking-wider
          whitespace-nowrap
          border-l
        ">
    Duration
  </th> -->
          <th class="
                table-cell
                px-4
                py-3
                bg-white
                text-left text-xs
                font-medium
                text-gray-500
                uppercase
                tracking-wider
                whitespace-nowrap
              ">
          </th>
        </tr>
      </thead>
      <tbody class="bg-white">
        <ng-container>
          <tr class="task-row group" *ngFor="let task of template.firm_template_tasks; let i=index; last as isLast">
            <td class="
                  px-1
                  py-1
                  max-w-0
                  w-full
                  whitespace-nowrap
                  text-sm
                  font-medium
                  text-gray-900
                  border-r border-t border-gray-200
                " [class.border-b]="!isLast">
              <div class="flex items-center">
                <editable-input [value]="task.name" placeholder="Enter a task name"
                  (onChange)="setDescription($event, i)" class="flex-1"></editable-input>
                <app-task-file-button [files]="task.firm_template_task_files"
                  (fileSelect)="attachFilesToTask($event, i)" (editFile)="editTaskFile($event)"
                  (deleteFile)="deleteTaskFile($event, i)"></app-task-file-button>
              </div>
            </td>
            <td class="
                px-1
                py-1
                w-full
                whitespace-nowrap
                text-sm
                font-medium
                text-gray-900
                border-r border-t border-gray-200
                " [class.border-b]="!isLast">
              <div>
                <ep-input-group>
                  <ep-avatar ep-input-icon epSize="xsmall" [epSrc]="task.user.profile_image" [epText]="task.user.full_name"></ep-avatar>

                  <input ep-input [epEditable]="true" type="text" [ngModel]="task.user_id"
                    (ngModelChange)="filterStaffMembers($event)" [epAutocomplete]="auto">
                </ep-input-group>

              <ep-autocomplete #auto="epAutocomplete" [displayWith]="displayFn"
                (optionSelected)="setAssignee($event, i)" panelWidth="auto">
                <ep-option *ngFor="let staffMember of filteredStaffMembers" [value]="staffMember.user.id">
                  <ep-avatar epSize="xsmall" [epSrc]="staffMember.user.profile_image"
                    [epText]="staffMember.user.full_name">
                  </ep-avatar> <span class="font-normal ml-3 block truncate">
                    {{staffMember.user.full_name}}
                  </span>
                </ep-option>
              </ep-autocomplete>
                <!-- <ep-editable>
                  <ng-template epEditableView>
                    <div class="relative" tabindex="0">
                      <div class="absolute inset-y-0 px-2 left-0 flex items-center pointer-events-none">
                        <ep-avatar epSize="xsmall" [epSrc]="task.user.profile_image"
                        [epText]="task.user.full_name">
                      </ep-avatar>
                      </div>
                      <span class="text-sm font-normal pl-10 pr-2 block truncate">
                        {{task.user.full_name}}
                      </span>
                    </div>
                  </ng-template>
                  <ng-template epEditableEdit>

                  </ng-template>
                </ep-editable> -->
              </div>
            </td>

            <td class="
                px-1
                py-1
                text-sm
                font-medium
                text-gray-900
                border-t border-gray-200
                " [class.border-b]="!isLast">
              <div>
                <input [(ngModel)]="task.no_of_days_from_start_date" type="number" min="0"
                  class="bg-transparent text-sm text-gray-800 w-full px-2 py-1 text-center border border-transparent border-dashed hover:bg-white hover:border-gray-300 focus:bg-white focus:border-transparent focus:shadow-sm">
              </div>
            </td>
            <!-- <td class="
            px-1
            py-1
            text-sm
            font-medium
            text-gray-900
            border-t border-b border-gray-200
            ">
          <div>
            <input [(ngModel)]="task.duration_minutes" [inputMask]="timeInputMask" class="bg-transparent text-sm text-gray-800 w-full px-2 py-1 text-center border border-transparent border-dashed hover:bg-white hover:border-gray-300 focus:bg-white focus:border-transparent focus:shadow-sm">
          </div>
        </td> -->
            <td class="
              px-1
              py-1
              text-sm
              font-medium
              text-gray-900
              border-t border-gray-200
              " [class.border-b]="!isLast">
              <div class="items-center flex">

                <button (click)="removeTemplateTask(i)" type="button"
                  class="-m-2 p-2 rounded-full flex items-center text-gray-300 hover:text-gray-600"
                  id="options-menu-0-button" aria-expanded="false" aria-haspopup="true">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd"
                      d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z"
                      clip-rule="evenodd" />
                  </svg>
                </button>
              </div>
            </td>
          </tr>
        </ng-container>

      </tbody>
    </table>

    <div class="text-center my-2" *ngIf="!template.firm_template_tasks.length">
      <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"
        aria-hidden="true">
        <path vector-effect="non-scaling-stroke" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z" />
      </svg>
      <h3 class="mt-2 text-sm font-medium text-gray-900">No tasks</h3>
      <p class="mt-1 text-sm text-gray-500">
        Get started by adding a task to this template.
      </p>
    </div>

  </div>

  <div class="mt-6 text-center">
    <button class="button-white-icon-sm" (click)="addTemplateTask();">
      <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd"
          d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z"
          clip-rule="evenodd" />
      </svg>
      Add Task
    </button>
  </div>
</div>
<div class="px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
  <button type="button" (click)="save()" [disabled]="!this.template.template_name"
    class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50">
    Save
  </button>
  <button type="button" (click)="close()"
    class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
    Cancel
  </button>
</div>